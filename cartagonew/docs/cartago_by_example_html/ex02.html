<p style="text-align: justify;">This example is a simple variation of the previous one, to show action failure.</p>
<p style="text-align: justify;">As in the previous case, two agents create, use and observe a shared artifact, in this case a <strong>bounded counter</strong>:</p>

<blockquote style="text-align: justify;">
<pre>MAS example01b_useobs {

  environment:
  c4jason.CartagoEnvironment

  agents:
  user2 agentArchClass c4jason.CAgentArch #1;
  observer agentArchClass c4jason.CAgentArch #1;

  classpath: "../../../lib/cartago.jar";"../../../lib/c4jason.jar";
}</pre>
</blockquote>
<p style="text-align: justify;">The counter used by the agents has the following code:</p>

<blockquote style="text-align: justify;">
<pre>public class BoundedCounter extends Artifact {
  private int max;

  void init(int max){
    defineObsProperty("count",0);
    this.max = max;
  }
  @OPERATION void inc(){
    ObsProperty prop = getObsProperty("count");
    if (prop.intValue() &lt; max){
      prop.updateValue(prop.intValue()+1);
      signal("tick");
    } else {
      failed("inc failed","inc_failed","max_value_reached",max);
    }
  }
}</pre>
</blockquote>
<p style="text-align: justify;"><strong>Highlights:</strong></p>

<ul style="text-align: justify;">
	<li> <strong>failed primitive:</strong> Differently from the non-bound case, in this case the <code>inc</code> action fails if the count already achieved the maximum value, specified as a parameter of <code>init</code>. To specify the failure of an operation the <code>failed</code> primitive is provided:
<ul>
	<li> <code>failed(String failureMsg)</code></li>
	<li> <code>failed(String failureMsg, String descr, Object... args)</code></li>
</ul>
An action feedback is generated, reporting a failure msg and optionally also a tuple <code>descr(Object...)</code> describing the failure.</li>
</ul>
<p style="text-align: justify;">Then, the <code>user2</code> agent creates a bounded counter with 50 as bound and tries to increment it 100 times: as soon as the maximum value is reached, the action <code>inc</code> fails and a repairing plan is executed:</p>

<blockquote style="text-align: justify;">
<pre>!create_and_use.

+!create_and_use : true
  &lt;- !setupTool(Id);
     !use(Id).

+!use(Counter)
  &lt;- for (.range(I,1,100)){
      inc [artifact_id(Counter)];
     }.

-!use(Counter) [error_msg(Msg),inc_failed("max_value_reached",Value)]
  &lt;- println(Msg);
     println("last value is ",Value).

+!setupTool(C): true
  &lt;- makeArtifact("c0","c4jexamples.BoundedCounter",[50],C).</pre>
</blockquote>
<p style="text-align: justify;"><strong>Highlights:</strong></p>

<ul style="text-align: justify;">
	<li> <strong>Failure info:</strong> on the Jason side, feedback information generated by<code> failed</code> on the artifact side are included in annotations in the repairing plan. In particular:
<ul>
	<li> <code>error_msg(Msg)</code> contains the failure message.</li>
	<li style="text-align: justify;"> the description tuple is directly included as annotation (<code>inc_failed(...)</code> in the example.</li>
</ul>
</li>
</ul>